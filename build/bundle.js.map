{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/internal/index.mjs","../../node_modules/svelte/easing/index.mjs","../../node_modules/svelte/transition/index.mjs","../../node_modules/svelte/store/index.mjs","../../src/stores.js","../../src/errorstore.js","../../src/WebHandler.js","../../src/LoginScreen.svelte","../../src/visuals/mouse.js","../../src/visuals/game.js","../../src/visuals/Canvas.svelte","../../src/visuals/Grid.svelte","../../src/visuals/Background.svelte","../../src/visuals/Room.svelte","../../src/visuals/Text.svelte","../../src/visuals/Figure.svelte","../../src/visuals/Hover.svelte","../../src/visuals/Door.svelte","../../src/util.js","../../src/GameInfoBar.svelte","../../src/contextmenu/menu.js","../../src/contextmenu/Menu.svelte","../../src/contextmenu/MenuOption.svelte","../../src/contextmenu/Modal.svelte","../../src/contextmenu/CustomMenu.svelte","../../src/visuals/FigureDrag.svelte","../../src/DungeonView.svelte","../../src/ErrorDisplay.svelte","../../src/App.svelte","../../src/main.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot_spread(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_spread_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_spread_changes_fn(dirty) | get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    const z_index = (parseInt(computed_style.zIndex) || 0) - 1;\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        `overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${z_index};`);\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            info.blocks[i] = null;\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.31.0' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to seperate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_custom_elements_slots, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, update_slot_spread, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","export { identity as linear } from '../internal/index.mjs';\n\n/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\nfunction backInOut(t) {\n    const s = 1.70158 * 1.525;\n    if ((t *= 2) < 1)\n        return 0.5 * (t * t * ((s + 1) * t - s));\n    return 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\nfunction backIn(t) {\n    const s = 1.70158;\n    return t * t * ((s + 1) * t - s);\n}\nfunction backOut(t) {\n    const s = 1.70158;\n    return --t * t * ((s + 1) * t + s) + 1;\n}\nfunction bounceOut(t) {\n    const a = 4.0 / 11.0;\n    const b = 8.0 / 11.0;\n    const c = 9.0 / 10.0;\n    const ca = 4356.0 / 361.0;\n    const cb = 35442.0 / 1805.0;\n    const cc = 16061.0 / 1805.0;\n    const t2 = t * t;\n    return t < a\n        ? 7.5625 * t2\n        : t < b\n            ? 9.075 * t2 - 9.9 * t + 3.4\n            : t < c\n                ? ca * t2 - cb * t + cc\n                : 10.8 * t * t - 20.52 * t + 10.72;\n}\nfunction bounceInOut(t) {\n    return t < 0.5\n        ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0))\n        : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\nfunction bounceIn(t) {\n    return 1.0 - bounceOut(1.0 - t);\n}\nfunction circInOut(t) {\n    if ((t *= 2) < 1)\n        return -0.5 * (Math.sqrt(1 - t * t) - 1);\n    return 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\nfunction circIn(t) {\n    return 1.0 - Math.sqrt(1.0 - t * t);\n}\nfunction circOut(t) {\n    return Math.sqrt(1 - --t * t);\n}\nfunction cubicInOut(t) {\n    return t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\nfunction cubicIn(t) {\n    return t * t * t;\n}\nfunction cubicOut(t) {\n    const f = t - 1.0;\n    return f * f * f + 1.0;\n}\nfunction elasticInOut(t) {\n    return t < 0.5\n        ? 0.5 *\n            Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) *\n            Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n        : 0.5 *\n            Math.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n            Math.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n            1.0;\n}\nfunction elasticIn(t) {\n    return Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction elasticOut(t) {\n    return (Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0);\n}\nfunction expoInOut(t) {\n    return t === 0.0 || t === 1.0\n        ? t\n        : t < 0.5\n            ? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n            : -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\nfunction expoIn(t) {\n    return t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction expoOut(t) {\n    return t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\nfunction quadInOut(t) {\n    t /= 0.5;\n    if (t < 1)\n        return 0.5 * t * t;\n    t--;\n    return -0.5 * (t * (t - 2) - 1);\n}\nfunction quadIn(t) {\n    return t * t;\n}\nfunction quadOut(t) {\n    return -t * (t - 2.0);\n}\nfunction quartInOut(t) {\n    return t < 0.5\n        ? +8.0 * Math.pow(t, 4.0)\n        : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\nfunction quartIn(t) {\n    return Math.pow(t, 4.0);\n}\nfunction quartOut(t) {\n    return Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\nfunction quintInOut(t) {\n    if ((t *= 2) < 1)\n        return 0.5 * t * t * t * t * t;\n    return 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\nfunction quintIn(t) {\n    return t * t * t * t * t;\n}\nfunction quintOut(t) {\n    return --t * t * t * t * t + 1;\n}\nfunction sineInOut(t) {\n    return -0.5 * (Math.cos(Math.PI * t) - 1);\n}\nfunction sineIn(t) {\n    const v = Math.cos(t * Math.PI * 0.5);\n    if (Math.abs(v) < 1e-14)\n        return 1;\n    else\n        return 1 - v;\n}\nfunction sineOut(t) {\n    return Math.sin((t * Math.PI) / 2);\n}\n\nexport { backIn, backInOut, backOut, bounceIn, bounceInOut, bounceOut, circIn, circInOut, circOut, cubicIn, cubicInOut, cubicOut, elasticIn, elasticInOut, elasticOut, expoIn, expoInOut, expoOut, quadIn, quadInOut, quadOut, quartIn, quartInOut, quartOut, quintIn, quintInOut, quintOut, sineIn, sineInOut, sineOut };\n","import { cubicInOut, linear, cubicOut } from '../easing/index.mjs';\nimport { is_function, assign } from '../internal/index.mjs';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\n\nfunction blur(node, { delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const f = style.filter === 'none' ? '' : style.filter;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `opacity: ${target_opacity - (od * u)}; filter: ${f} blur(${u * amount}px);`\n    };\n}\nfunction fade(node, { delay = 0, duration = 400, easing = linear }) {\n    const o = +getComputedStyle(node).opacity;\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `opacity: ${t * o}`\n    };\n}\nfunction fly(node, { delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * x}px, ${(1 - t) * y}px);\n\t\t\topacity: ${target_opacity - (od * u)}`\n    };\n}\nfunction slide(node, { delay = 0, duration = 400, easing = cubicOut }) {\n    const style = getComputedStyle(node);\n    const opacity = +style.opacity;\n    const height = parseFloat(style.height);\n    const padding_top = parseFloat(style.paddingTop);\n    const padding_bottom = parseFloat(style.paddingBottom);\n    const margin_top = parseFloat(style.marginTop);\n    const margin_bottom = parseFloat(style.marginBottom);\n    const border_top_width = parseFloat(style.borderTopWidth);\n    const border_bottom_width = parseFloat(style.borderBottomWidth);\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => 'overflow: hidden;' +\n            `opacity: ${Math.min(t * 20, 1) * opacity};` +\n            `height: ${t * height}px;` +\n            `padding-top: ${t * padding_top}px;` +\n            `padding-bottom: ${t * padding_bottom}px;` +\n            `margin-top: ${t * margin_top}px;` +\n            `margin-bottom: ${t * margin_bottom}px;` +\n            `border-top-width: ${t * border_top_width}px;` +\n            `border-bottom-width: ${t * border_bottom_width}px;`\n    };\n}\nfunction scale(node, { delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const sd = 1 - start;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - (sd * u)});\n\t\t\topacity: ${target_opacity - (od * u)}\n\t\t`\n    };\n}\nfunction draw(node, { delay = 0, speed, duration, easing = cubicInOut }) {\n    const len = node.getTotalLength();\n    if (duration === undefined) {\n        if (speed === undefined) {\n            duration = 800;\n        }\n        else {\n            duration = len / speed;\n        }\n    }\n    else if (typeof duration === 'function') {\n        duration = duration(len);\n    }\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `stroke-dasharray: ${t * len} ${u * len}`\n    };\n}\nfunction crossfade(_a) {\n    var { fallback } = _a, defaults = __rest(_a, [\"fallback\"]);\n    const to_receive = new Map();\n    const to_send = new Map();\n    function crossfade(from, node, params) {\n        const { delay = 0, duration = d => Math.sqrt(d) * 30, easing = cubicOut } = assign(assign({}, defaults), params);\n        const to = node.getBoundingClientRect();\n        const dx = from.left - to.left;\n        const dy = from.top - to.top;\n        const dw = from.width / to.width;\n        const dh = from.height / to.height;\n        const d = Math.sqrt(dx * dx + dy * dy);\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        const opacity = +style.opacity;\n        return {\n            delay,\n            duration: is_function(duration) ? duration(d) : duration,\n            easing,\n            css: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${t + (1 - t) * dh});\n\t\t\t`\n        };\n    }\n    function transition(items, counterparts, intro) {\n        return (node, params) => {\n            items.set(params.key, {\n                rect: node.getBoundingClientRect()\n            });\n            return () => {\n                if (counterparts.has(params.key)) {\n                    const { rect } = counterparts.get(params.key);\n                    counterparts.delete(params.key);\n                    return crossfade(rect, node, params);\n                }\n                // if the node is disappearing altogether\n                // (i.e. wasn't claimed by the other list)\n                // then we need to supply an outro\n                items.delete(params.key);\n                return fallback && fallback(node, params, intro);\n            };\n        };\n    }\n    return [\n        transition(to_send, to_receive, false),\n        transition(to_receive, to_send, true)\n    ];\n}\n\nexport { blur, crossfade, draw, fade, fly, scale, slide };\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","import { writable } from 'svelte/store';\r\n\r\nexport { game, addPlayer, showRoom, showDoor, removePlayer, hideDoor, hideRoom, resetGame, addFigure, moveFigure, removeFigure };\r\n\r\nconst game = writable({id: -1});\r\n\r\n//> PLAYERS\r\n\r\nfunction addPlayer(playerName) {\r\n  game.update(g => {\r\n    g.playerNames.push(playerName);\r\n    return g;\r\n  });\r\n}\r\n\r\nfunction removePlayer(user) {\r\n  game.update(g => {\r\n    let playerIndex = g.playerNames.findIndex(u => u.name === user.name);\r\n    if(playerIndex > 0) g.playerNames.splice(playerIndex, 1);\r\n    return g;\r\n  });\r\n}\r\n\r\n//> ROOMS\r\n\r\nfunction showRoom(room) {\r\n  game.update(g => {\r\n    if(g.thisPlayer.isMaster) {\r\n      let r = g.dungeon.rects.find(r => r.x == room.x && r.y == room.y && r.w == room.w && r.h == room.h);\r\n      r.visible = room.visible;\r\n    } else {\r\n      g.dungeon.rects = [...g.dungeon.rects, room];\r\n    }\r\n    return g;\r\n  });\r\n}\r\n\r\nfunction hideRoom(room) {\r\n  game.update(g => {\r\n    if(g.thisPlayer.isMaster) {\r\n      let r = g.dungeon.rects.find(r => r.x == room.x && r.y == room.y && r.w == room.w && r.h == room.h);\r\n      r.visible = room.visible;\r\n    } else {\r\n      let roomIndex = g.dungeon.rects.findIndex(r => r.x == room.x && r.y == room.y && r.w == room.w && r.h == room.h);\r\n      if(roomIndex >= 0) g.dungeon.rects.splice(roomIndex, 1);\r\n    }\r\n    return g;\r\n  });\r\n}\r\n\r\n//> DOORS\r\n\r\nfunction showDoor(room) {\r\n  game.update(g => {\r\n    if(!g.thisPlayer.isMaster) {\r\n      g.dungeon.doors = [...g.dungeon.doors, room];\r\n    }\r\n    return g;\r\n  });\r\n}\r\n\r\nfunction hideDoor(door) {\r\n  game.update(g => {\r\n    if(!g.thisPlayer.isMaster) {\r\n      let doorIndex = g.dungeon.doors.findIndex(e=>e.x === door.x && e.y === door.y);\r\n      if(doorIndex >= 0) g.dungeon.doors.splice(doorIndex, 1);\r\n\r\n    }\r\n    return g;\r\n  });\r\n}\r\n\r\n//> FIGURE\r\n\r\nfunction addFigure(fig) {\r\n  game.update(g => {\r\n    g.dungeon.figures.push(fig);\r\n    return g;\r\n  })\r\n}\r\n\r\nfunction moveFigure(fig, to) {\r\n  game.update(g => {\r\n    let f = g.dungeon.figures.find(e => e.x === fig.x && e.y === fig.y);\r\n    f.x = to.x;\r\n    f.y = to.y;\r\n    return g;\r\n  })\r\n}\r\n\r\nfunction removeFigure(fig) {\r\n  game.update(g => {\r\n    let figureIndex = g.dungeon.figures.findIndex(e => e.x === fig.x && e.y === fig.y);\r\n    if(figureIndex >= 0) g.dungeon.figures.splice(figureIndex, 1);\r\n    return g;\r\n  })\r\n}\r\n\r\nfunction resetGame() {\r\n  game.set({ id: -1 });\r\n}\r\n","import { writable } from 'svelte/store';\r\nexport { error, setError, resetError }\r\n\r\nconst error = writable({ message: \"\", timeout: {}});\r\n\r\nfunction setError(message) {\r\n  error.update(e => {\r\n    e.message = message;\r\n\r\n    if(e.timeout) clearTimeout(e.timeout);\r\n    if(message) e.timeput = setInterval(resetError , 5 * 1000);\r\n\r\n    return e;\r\n  });\r\n}\r\n\r\nfunction resetError() {\r\n  setError(\"\");\r\n}\r\n","//DEPLOY\r\nconst host = \"vast-cliffs-53607.herokuapp.com\";\r\n\r\n//DEV /*\r\n//const host  = \"localhost\";\r\n//const port = 3000;\r\n\r\nlet socketConnection;\r\n\r\nfunction sendRequest(data) {\r\n  return new Promise(function (resolve, reject) {\r\n    let xmlhttp = new XMLHttpRequest();\r\n\r\n      xmlhttp.onload = function () {\r\n        var status = xmlhttp.status;\r\n        if (status == 200) {\r\n            resolve(JSON.parse(xmlhttp.responseText));\r\n        } else {\r\n          reject(status);\r\n        }\r\n      };\r\n\r\n      xmlhttp.onerror = function(er) {\r\n        resolve({ isError: true, error: \"The Server seems to be offline.\" });\r\n      }\r\n\r\n      //DEPLOY\r\n      xmlhttp.open(\"POST\", `https://${host}`, true);\r\n\r\n     //DEV\r\n     //xmlhttp.open(\"POST\", `http://${host}:${port}`, true);\r\n\r\n     xmlhttp.setRequestHeader(\"Content-type\", \"application/json\");\r\n     xmlhttp.send(data);\r\n  })\r\n}\r\n\r\nfunction createGame(gameName, masterName) {\r\n  let data = {\r\n    action: \"createGame\",\r\n    gameName: gameName,\r\n    masterName: masterName\r\n  }\r\n\r\n  return sendRequest(JSON.stringify(data));\r\n}\r\n\r\nfunction joinGame(gameID, playerName) {\r\n  let data = {\r\n    action: \"joinGame\",\r\n    gameID: gameID,\r\n    playerName: playerName\r\n  }\r\n\r\n  return sendRequest(JSON.stringify(data));\r\n}\r\n\r\nimport { get } from 'svelte/store';\r\nimport { game, addPlayer, showRoom, showDoor, removePlayer, hideRoom, hideDoor, resetGame, addFigure, moveFigure, removeFigure } from './stores.js';\r\nimport { setError } from './errorstore.js';\r\n\r\nfunction openSocket(gameID, playerID) {\r\n  //DEPLOY\r\n  socketConnection = new WebSocket(`wss://${host}/websocket`);\r\n\r\n  //DEV\r\n  //socketConnection = new WebSocket(`ws://${host}:8080`);\r\n\r\n  socketConnection.onopen = function () {\r\n    let data = {action: \"register\", pid: playerID, gid: gameID};\r\n    socketConnection.send(JSON.stringify(data));\r\n  };\r\n\r\n  socketConnection.onmessage = function (e) {\r\n    let data = JSON.parse(e.data);\r\n\r\n    if(data.isError) {\r\n      setError(data.message);\r\n    }\r\n\r\n    if(data.action != \"ping\") console.log(data);\r\n    if(data.action === \"userJoined\") {\r\n      addPlayer(data.user);\r\n    } else if(data.action === \"showRoom\") {\r\n      showRoom(data.room);\r\n    } else if(data.action === \"showDoor\") {\r\n      showDoor(data.door)\r\n    } else if(data.action === \"kick\") {\r\n      if(socketConnection) socketConnection.close();\r\n      resetGame();\r\n      setError(\"You were kicked: \" + data.message);\r\n    } else if(data.action === \"ping\") {\r\n      let gameID = get(game).id;\r\n      let playerID = get(game).thisPlayer.id;\r\n      let data = {action: \"pong\", pid: playerID, gid: gameID};\r\n      socketConnection.send(JSON.stringify(data));\r\n    } else if(data.action === \"userLeft\") {\r\n      removePlayer(data.user);\r\n    } else if(data.action === \"hideDoor\") {\r\n      hideDoor(data.door);\r\n    } else if(data.action === \"hideRoom\") {\r\n      hideRoom(data.room)\r\n    } else if(data.action === \"addFigure\") {\r\n      addFigure(data.figure);\r\n    } else if(data.action === \"moveFigure\") {\r\n      moveFigure(data.figure, data.to);\r\n    } else if(data.action === \"removeFigure\") {\r\n      removeFigure(data.figure);\r\n    }\r\n  };\r\n}\r\n\r\nfunction sendShowRoom(room, gid, pid) {\r\n  let data = { action: \"showRoom\", room: room, pid: pid, gid: gid }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendShowDoor(room, gid, pid) {\r\n  let data = { action: \"showDoor\", door: room, pid: pid, gid: gid }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendHideRoom(room, gid, pid) {\r\n  let data = { action: \"hideRoom\", room: room, pid: pid, gid: gid }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendHideDoor(room, gid, pid) {\r\n  let data = { action: \"hideDoor\", door: room, pid: pid, gid: gid }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendPlayerLeave(gid, pid) {\r\n  let data = { action: \"playerLeave\", pid: pid, gid: gid }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendCreateFigure(fig, gid, pid) {\r\n  let data = { action: \"addFigure\", pid: pid, gid: gid, figure: fig }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendMoveFigure(fig, to, gid, pid) {\r\n  let data = { action: \"moveFigure\", pid: pid, gid: gid, figure: fig, to: to }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nfunction sendDeleteFigure(fig, gid, pid) {\r\n  let data = { action: \"removeFigure\", pid: pid, gid: gid, figure: fig }\r\n  let dataStr = JSON.stringify(data);\r\n  if(socketConnection) socketConnection.send(dataStr);\r\n}\r\n\r\nexport { createGame, openSocket, joinGame, sendShowRoom, sendShowDoor, sendHideRoom, sendHideDoor, sendPlayerLeave, sendCreateFigure, sendMoveFigure, sendDeleteFigure };\r\n","<script>\r\n\timport { fly } from 'svelte/transition';\r\n\timport { createGame, openSocket, joinGame } from './WebHandler.js';\r\n\timport { game } from './stores.js';\r\n\timport { setError, resetError } from './errorstore.js';\r\n\r\n\tlet gameName = \"\";\r\n\tlet playerName = \"\";\r\n\tlet loading = 0;\r\n\r\n\tasync function clickCreate() {\r\n\t\tloading = 1;\r\n\t\tlet answer = await createGame(gameName, playerName);\r\n\t\tloading = 0;\r\n\r\n\t\tif(!answer.isError) {\r\n\t\t\t$game = {\r\n\t\t\t\tid: answer.game.id,\r\n\t\t\t\tname: answer.game.name,\r\n\t\t\t\tplayerNames: [\r\n\t\t\t\t\t{ name: playerName, isMaster: true, isYou: true }\r\n\t\t\t\t],\r\n\t\t\t\tthisPlayer: {\r\n\t\t\t\t\tid: answer.player.id,\r\n\t\t\t\t\tname: playerName,\r\n\t\t\t\t\tisMaster: true,\r\n\t\t\t\t\tisYou: true\r\n\t\t\t\t},\r\n\t\t\t\tdungeon: answer.dungeon,\r\n\t\t\t};\r\n\r\n\t\t\topenSocket($game.id, $game.thisPlayer.id);\r\n\t\t\tresetError();\r\n\t\t} else {\r\n\t\t\tsetError(answer.error);\r\n\t\t}\r\n\t}\r\n\r\n\tasync function clickJoin() {\r\n\t\tloading = 2;\r\n\t\tlet answer = await joinGame(gameName, playerName);\r\n\t\tloading = 0;\r\n\r\n\t\tif(!answer.isError) {\r\n\t\t\t$game = {\r\n\t\t\t\tid: answer.id,\r\n\t\t\t\tname: answer.gameName,\r\n\t\t\t\tplayerNames: answer.player,\r\n\t\t\t\tthisPlayer: {\r\n\t\t\t\t\tid: answer.playerID,\r\n\t\t\t\t\tname: playerName,\r\n\t\t\t\t\tisMaster: false,\r\n\t\t\t\t\tisYou: true\r\n\t\t\t\t},\r\n\t\t\t\tdungeon: answer.dungeon\r\n\t\t\t};\r\n\r\n\t\t\topenSocket($game.id, $game.thisPlayer.id);\r\n\t\t\tresetError();\r\n\t\t} else {\r\n\t\t\tsetError(answer.error);\r\n\t\t}\r\n}\r\n</script>\r\n\r\n\r\n<div class=\"main card\">\r\n\t<div class=\"row\">\r\n\t\t<div class=\"col\">\r\n\t  <input placeholder=\"Enter Game Name\" class=\"is-rounded\" bind:value={gameName} disabled={loading} />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=\"row\">\r\n\t\t<div class=\"col\">\r\n\t\t\t<input placeholder=\"Enter your Name\" class=\"is-rounded\" bind:value={playerName} disabled={loading} />\r\n\t\t</div>\r\n\r\n\t\t<div class=\"col-2\">\r\n\t\t\t<button class=\"button is-full-width\" on:click={clickJoin} disabled={loading}>\r\n\t\t\t\t\tJoin Game\r\n\t\t\t\t\t{#if loading == 2}\r\n\t\t\t\t\t\t<div transition:fly=\"{{ x: -15, duration: 100 }}\"><div class=\"ld ld-ring ld-spin\"></div></div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t</button>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class=\"col-2\">\r\n\t\t\t<button class=\"button primary is-full-width\" on:click={clickCreate} disabled={loading}>\r\n\t\t\t\tCreate Game\r\n\t\t\t\t{#if loading == 1}\r\n\t\t\t\t\t<div transition:fly=\"{{ x: -15, duration: 100 }}\"><div class=\"ld ld-ring ld-spin\"></div></div>\r\n\t\t\t\t{/if}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<style>\r\n.main {\r\n\twidth: 75%;\r\n\tmargin-top: 32px;\r\n\tmargin-left: auto;\r\n  margin-right: auto;\r\n\tbackground: var(--bg-secondary-color);\r\n}\r\n\r\n.button {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-content: center;\r\n}\r\n\r\n.button div {\r\n\tmargin-left: 8px;\r\n}\r\n</style>\r\n","import { writable } from 'svelte/store';\r\n\r\nlet mouse = writable({\r\n  screenX: 0,\r\n  screenY: 0,\r\n  worldX: 0,\r\n  worldY: 0,\r\n  tileX: 0,\r\n  tileY: 0,\r\n  entered: true,\r\n  pick: false,\r\n  down: 0\r\n});\r\n\r\nexport { mouse, }\r\n","import { getContext, onMount, onDestroy } from 'svelte';\r\nimport { writable, derived } from 'svelte/store';\r\n\r\n// Some props for the app\r\nexport const width = writable(window.innerWidth);\r\nexport const height = writable(window.innerHeight);\r\nexport const pixelRatio = writable(window.devicePixelRatio);\r\nexport const context = writable();\r\nexport const canvas = writable();\r\nexport const cam = writable({dx: 0, dy: 0});\r\nexport const time = writable(0);\r\nexport const tileSize = writable(32);\r\nexport const colors = writable({\r\n\tbackground: \"#0E0E0E\",\r\n\trooms: \"#EEEEEE\",\r\n\tlastFigureColors: []\r\n})\r\n\r\n\r\n// A more convenient store for grabbing all game props\r\nexport const props = deriveObject({\r\n\tcontext,\r\n\tcanvas,\r\n\twidth,\r\n\theight,\r\n\tpixelRatio,\r\n\ttime,\r\n});\r\n\r\nexport const key = Symbol();\r\n\r\nexport const getState = () => {\r\n\tconst api = getContext(key);\r\n\treturn api.getState();\r\n};\r\n\r\nexport const renderable = (render) => {\r\n\tconst api = getContext(key);\r\n\tconst element = {\r\n\t\tready: false,\r\n\t\tmounted: false\r\n\t};\r\n\tif (typeof render === 'function') {\r\n\t\telement.render = render;\r\n\t\telement.height = 0;\r\n\t} else if (render) {\r\n\t\tif (render.render) element.render = render.render;\r\n\t\tif (render.setup) element.setup = render.setup;\r\n\t\tif (render.height) element.height = render.height;\r\n\t}\r\n\tapi.add(element);\r\n\tonMount(() => {\r\n\t\telement.mounted = true;\r\n\t\treturn () => {\r\n\t\t\tapi.remove(element);\r\n\t\t\telement.mounted = false;\r\n\t\t};\r\n\t});\r\n}\r\n\r\nfunction deriveObject (obj) {\r\n\tconst keys = Object.keys(obj);\r\n\tconst list = keys.map(key => {\r\n\t\treturn obj[key];\r\n\t});\r\n\treturn derived(list, (array) => {\r\n\t\treturn array.reduce((dict, value, i) => {\r\n\t\t\tdict[keys[i]] = value;\r\n\t\t\treturn dict;\r\n\t\t}, {});\r\n\t});\r\n}\r\n","<script>\r\n\timport { onMount, onDestroy, setContext } from 'svelte';\r\n\timport { createEventDispatcher } from 'svelte';\r\n\timport { mouse } from './mouse.js'\r\n\timport { game } from '../stores.js'\r\n\timport { key, width, height, canvas as canvasStore, context as contextStore, \tpixelRatio, props, time, tileSize, cam, } from './game.js';\r\n\timport { sendMoveFigure } from '../WebHandler.js';\r\n\r\n\texport let killLoopOnError = true;\r\n\texport let attributes = {};\r\n\r\n\tlet clickStart;\r\n\tlet listeners = [];\r\n\tlet canvas;\r\n\tlet context;\r\n\tlet frame;\r\n\r\n\tonMount(() => {\r\n\t\t// prepare canvas stores\r\n\t\tcontext = canvas.getContext('2d', attributes);\r\n\t\tcanvasStore.set(canvas);\r\n\t\tcontextStore.set(context);\r\n\r\n\t\t// start game loop\r\n\t\treturn createLoop((elapsed, dt) => {\r\n\t\t\ttime.set(elapsed);\r\n\t\t\trender(dt);\r\n\t\t});\r\n\t});\r\n\r\n\tsetContext(key, {\r\n\t\tadd (fn) {\r\n\t\t\tthis.remove(fn);\r\n\t\t\tlisteners.push(fn);\r\n\r\n\t\t\tif (fn.setup) {\r\n\t\t\t\tlet p = fn.setup($props);\r\n\t\t\t\tif (p && p.then) p;\r\n\t\t\t}\r\n\t\t\tfn.ready = true;\r\n\r\n\t\t\tlisteners.sort((e1, e2) => e1.height - e2.height);\r\n\t\t},\r\n\t\tremove (fn) {\r\n\t\t\tconst idx = listeners.indexOf(fn);\r\n\t\t\tif (idx >= 0) listeners.splice(idx, 1);\r\n\t\t}\r\n\t});\r\n\r\n\tfunction render (dt) {\r\n\t\tcontext.save();\r\n\r\n\t\tcontext.translate(-$cam.dx, -$cam.dy);\r\n\t\tcontext.scale($pixelRatio, $pixelRatio);\r\n\t\tlisteners.forEach(entity => {\r\n\t\t\ttry {\r\n\t\t\t\tif (entity.mounted && entity.ready && entity.render) {\r\n\t\t\t\t\tentity.render($props, dt);\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\tif (killLoopOnError) {\r\n\t\t\t\t\tcancelAnimationFrame(frame);\r\n\t\t\t\t\tconsole.warn('Animation loop stopped due to an error');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tcontext.restore();\r\n\t}\r\n\r\n\tfunction handleResize () {\r\n\t\twidth.set(window.innerWidth);\r\n\t\theight.set(window.innerHeight);\r\n\t\tpixelRatio.set(window.devicePixelRatio);\r\n\t}\r\n\r\n\tfunction createLoop (fn) {\r\n\t\tlet elapsed = 0;\r\n\t\tlet lastTime = performance.now();\r\n\t\t(function loop() {\r\n\t\t\tframe = requestAnimationFrame(loop);\r\n\t\t\tconst beginTime = performance.now();\r\n\t\t\tconst dt = (beginTime - lastTime) / 1000;\r\n\t\t\tlastTime = beginTime;\r\n\t\t\telapsed += dt;\r\n\t\t\tfn(elapsed, dt);\r\n\t\t})();\r\n\t\treturn () => {\r\n\t\t\tcancelAnimationFrame(frame);\r\n\t\t};\r\n\t}\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\tfunction handleMouseUp(ev) {\r\n\t\t$mouse.down = false;\r\n\r\n\t\tlet timeDis = Date.now() - clickStart;\r\n\t\tlet data = {\r\n\t\t\tx: $mouse.worldX,\r\n\t\t\ty: $mouse.worldY,\r\n\t\t\ttileX: $mouse.tileX,\r\n\t\t\ttileY: $mouse.tileY\r\n\t\t}\r\n\r\n\t\tlet newPos = false;\r\n\t\tif($mouse.pick) {\r\n\t\t\tlet x = $mouse.pick.x;\r\n\t\t\tlet y = $mouse.pick.y;\r\n\r\n\t\t\tlet newX = Math.round($mouse.tileX * 2) / 2 - 0.5;\r\n\t\t\tlet newY = Math.round($mouse.tileY * 2) / 2 - 0.5;\r\n\t\t\tnewPos = !(x === newX && $mouse.pick.y === newY);\r\n\r\n\t\t\tif(newPos) sendMoveFigure($mouse.pick, { x: newX, y: newY }, $game.id, $game.thisPlayer.id);\r\n\t\t\t$mouse.pick = false;\r\n\t\t}\r\n\r\n\t\tif(timeDis < 200 && !newPos && ev.button === 0) dispatch('click', data);\r\n\t}\r\n\r\n\tfunction handleMouseMove(event) {\r\n\t\tif($mouse.enter) {\r\n\t\t\tif($mouse.down ) {\r\n\t\t\t\tif(!$mouse.pick) {\r\n\t\t\t\t\t$cam = {\r\n\t\t\t\t\t\tdx: $cam.dx + ($mouse.screenX - event.x) * $pixelRatio,\r\n\t\t\t\t\t\tdy: $cam.dy + ($mouse.screenY - event.y) * $pixelRatio\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$mouse.screenX = event.x;\r\n\t\t\t$mouse.screenY = event.y;\r\n\t\t\t$mouse.worldX = event.x + $cam.dx/$pixelRatio;\r\n\t\t\t$mouse.worldY = event.y + $cam.dy/$pixelRatio;\r\n\t\t\t$mouse.tileX = $mouse.worldX / $tileSize;\r\n\t\t\t$mouse.tileY = $mouse.worldY / $tileSize;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction handleMouseDown(event) {\r\n\t\t$mouse.down = true;\r\n\t\tclickStart = Date.now();\r\n\t\tif(event.button === 0) dispatch('down', event);\r\n\t}\r\n</script>\r\n\r\n<canvas\r\n\ton:mousemove={handleMouseMove}\r\n\ton:mousedown={handleMouseDown}\r\n\ton:mouseup={handleMouseUp}\r\n\ton:mouseenter={$mouse.enter=true}\r\n\ton:mouseleave={$mouse.enter=false}\r\n\tbind:this={canvas}\r\n\twidth={$width * $pixelRatio}\r\n\theight={$height * $pixelRatio}\r\n\tstyle=\"width: {$width}px; height: {$height}px;\"\r\n/>\r\n<svelte:window on:resize|passive={handleResize} />\r\n<slot></slot>\r\n\r\n<style>\r\n\r\n\r\n</style>\r\n","<script>\r\n\timport { renderable, tileSize, height, width, cam, pixelRatio, colors } from './game.js';\r\n\r\n\texport let color = $colors.background + '6';\r\n\r\n\trenderable({\r\n\t\trender: props => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tcontext.save();\r\n\r\n\t\t\tlet pr = $pixelRatio;\r\n\r\n\t\t\tlet dx = $cam.dx / pr;\r\n\t\t\tlet dy = $cam.dy / pr;\r\n\t\t\tlet w = width;\r\n\t\t\tlet h = height;\r\n\r\n\t\t\tlet offX = dx / $tileSize;\r\n\t\t\tif(offX < 0) offX = Math.floor(offX);\r\n\t\t\telse offX = Math.ceil(offX);\r\n\r\n\t\t\tlet offY = dy / $tileSize;\r\n\t\t\tif(offY < 0) offY = Math.floor(offY);\r\n\t\t\telse offY = Math.ceil(offY);\r\n\r\n\t\t\tfor(let x = Math.min(0, offX); x < Math.max(0, offX) + w / $tileSize; x++) {\r\n\t\t\t\tcontext.beginPath();\r\n\t\t\t\tcontext.strokeStyle = color;\r\n\t\t\t\tcontext.moveTo(x * $tileSize, dy);\r\n\t\t\t\tcontext.lineTo(x * $tileSize, h + dy);\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t}\r\n\r\n\t\t\tfor(let y = Math.min(0, offY); y < Math.max(0, offY) + h / $tileSize; y++) {\r\n\t\t\t\tcontext.beginPath();\r\n\t\t\t\tcontext.strokeStyle = color;\r\n\t\t\t\tcontext.moveTo(dx, y * $tileSize);\r\n\t\t\t\tcontext.lineTo(dx + w, y * $tileSize);\r\n\t\t\t\tcontext.stroke();\r\n\t\t\t}\r\n\r\n\t\t\tcontext.restore();\r\n\t\t}, height: 3\r\n\t});\r\n</script>\r\n\r\n<!-- The following allows this component to nest children -->\r\n<slot></slot>\r\n","<script>\r\n\timport { renderable, colors, cam, pixelRatio } from './game.js';\r\n\tlet color = $colors.background + \"F\";\r\n\r\n\trenderable(props => {\r\n\t\tconst { context, width, height } = props;\r\n\r\n\t\tcontext.save();\r\n\t\tlet pr = $pixelRatio;\r\n\r\n\t\tcontext.clearRect($cam.dx/ pr, $cam.dy/ pr, width, height);\r\n\t\tif (color) {\r\n\t\t\tcontext.fillStyle = color;\r\n\t\t\tcontext.fillRect($cam.dx/ pr, $cam.dy/ $pixelRatio, width, height);\r\n\t\t}\r\n\r\n\t\tcontext.restore();\r\n\t});\r\n</script>\r\n\r\n<!-- The following allows this component to nest children -->\r\n<slot></slot>\r\n","<script>\r\n\timport { renderable, width, height, tileSize, colors } from './game.js';\r\n\r\n\tlet color = '#F8F8F4';\r\n\texport let dimension;\r\n\r\n\trenderable({\r\n\t\trender: (props, dt) => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tcontext.save();\r\n\r\n\t\t\tif(dimension) {\r\n\t\t\t\tlet x = dimension.x * $tileSize;\r\n\t\t\t\tlet y = dimension.y * $tileSize;\r\n\t\t\t\tlet w = dimension.w * $tileSize;\r\n\t\t\t\tlet h = dimension.h * $tileSize;\r\n\r\n\t\t\t\tif(!dimension.rotunda) {\r\n\t\t\t\t\tcontext.fillStyle = $colors.rooms;\r\n\t\t\t\t\tcontext.fillRect(x, y, w, h);\r\n\t\t\t\t\tif(!dimension.visible) {\r\n\t\t\t\t\t\tcontext.fillStyle = dimension.visible? '#0F06': '#F006';\r\n\t\t\t\t\t\tcontext.fillRect(x, y, w, h);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontext.beginPath();\r\n\t\t\t\t\tcontext.fillStyle = $colors.rooms;\r\n\t\t\t\t\tcontext.ellipse(x + w/2, y + h/2, w/2, h/2, 0, 0, Math.PI * 2);\r\n\t\t\t\t\tcontext.closePath();\r\n\t\t\t\t\tcontext.fill();\r\n\t\t\t\t\tcontext.beginPath();\r\n\t\t\t\t\tif(!dimension.visible) {\r\n\t\t\t\t\t\tcontext.fillStyle = dimension.visible? '#0F06': '#F006';\r\n\t\t\t\t\t\tcontext.ellipse(x + w/2, y + h/2, w/2, h/2, 0, 0, Math.PI * 2);\r\n\t\t\t\t\t\tcontext.closePath();\r\n\t\t\t\t\t\tcontext.fill();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcontext.restore();\r\n\t\t}, height: 1\r\n\t});\r\n</script>\r\n","<script>\r\n\timport { renderable, tileSize, colors } from './game.js';\r\n\r\n\tlet color = '#000000';\r\n\texport let baseline = 'middle';\r\n\r\n\texport let pos;\r\n\r\n\texport let fontSize = 16;\r\n\texport let fontFamily = '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica';\r\n\r\n\trenderable({\r\n\t\trender: props => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tif (pos.name) {\r\n\r\n\t\t\t\tcontext.font = `${fontSize}px ${fontFamily}`;\r\n\t\t\t\tcontext.textBaseline = baseline;\r\n\r\n\t\t\t\tlet textWidth = context.measureText(pos.name).width;\r\n\r\n\t\t\t\tcontext.fillStyle = $colors.rooms;\r\n\t\t\t\tcontext.fillRect(pos.x * $tileSize + $tileSize/2 - textWidth/2 - 2, pos.y * $tileSize + $tileSize - 4 - 2, textWidth + 4, fontSize + 4)\r\n\r\n\t\t\t\tcontext.fillStyle = $colors.background + \"FF\";\r\n\t\t\t\tcontext.fillText(pos.name, pos.x * $tileSize + $tileSize/2 - textWidth/2, pos.y * $tileSize + $tileSize - 4);\r\n\t\t\t}\r\n\t\t}, height: 6\r\n\t});\r\n</script>\r\n\r\n<!-- The following allows this component to nest children -->\r\n<slot></slot>\r\n","<script>\r\n\timport { renderable, width, height, tileSize, colors } from './game.js';\r\n\timport Text from './Text.svelte';\r\n\r\n\texport let pos;\r\n\r\n\trenderable({\r\n\t\trender: (props, dt) => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tcontext.save();\r\n\r\n\t\t\tlet x = pos.x * $tileSize;\r\n\t\t\tlet y = pos.y * $tileSize;\r\n\t\t\tlet w = $tileSize - 8;\r\n\t\t\tlet h = $tileSize - 8;\r\n\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.fillStyle = pos.color;\r\n\t\t\tcontext.ellipse(x + $tileSize/2, y + $tileSize/2, w/2, h/2, 0, 0, Math.PI * 2);\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.fill();\r\n\t\t\tcontext.beginPath();\r\n\r\n\t\t\tcontext.restore();\r\n\t\t}, height: 7\r\n\t});\r\n</script>\r\n\r\n<Text\r\n\tfontSize={16}\r\n\tbaseline='top'\r\n\tbind:pos={pos}\r\n/>\r\n","<script>\r\n\timport { renderable, width, height, tileSize } from './game.js';\r\n\r\n\texport let color = '#F8F8F4';\r\n\texport let dimension;\r\n\r\n\trenderable({\r\n\t\trender: (props, dt) => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tcontext.save();\r\n\r\n\t\t\tif(dimension) {\r\n\t\t\t\tcontext.strokeStyle = '#FF0';\r\n\t      context.lineWidth = 3;\r\n\t\t\t\tcontext.strokeRect(dimension.x * $tileSize, dimension.y * $tileSize, dimension.w * $tileSize, dimension.h * $tileSize);\r\n\t      context.lineWidth = 1;\r\n\t\t\t}\r\n\r\n\t\t\tcontext.restore();\r\n\t\t}, height: 4\r\n\t});\r\n</script>\r\n","<script>\r\n\timport { renderable, width, height, tileSize, colors } from './game.js';\r\n\r\n\texport let dimension;\r\n\r\n\trenderable({\r\n\t\trender: (props, dt) => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tcontext.save();\r\n\r\n\t\t\tif(dimension) {\r\n\t\t\t\tif(dimension.type > 0) {\r\n\t\t\t\t\tif(dimension.type == 1) {\t//Normal Door\r\n\t\t\t\t\t\tdrawSmallWay(context);\r\n\t\t\t\t\t\tdrawDoor(context, 1);\r\n\t\t\t\t\t} else if(dimension.type == 2) {\t//Smaller Way\r\n\t\t\t\t\t\tdrawSmallWay(context);\r\n\t\t\t\t\t} else if(dimension.type == 3) {\t//STAIR UP\r\n\t\t\t\t\t\t\tdrawStair(context);\r\n\t\t\t\t\t} else if(dimension.type == 4){\t//??\r\n\r\n\t\t\t\t\t} else if(dimension.type == 5) {\t//DOUBLE DOOR\r\n\t\t\t\t\t\tdrawSmallWay(context);\r\n\t\t\t\t\t\tdrawDoor(context, 5);\r\n\t\t\t\t\t} else if(dimension.type == 6) {\t//HIDDEN\r\n\t\t\t\t\t\tdrawHidden(context);\r\n\t\t\t\t\t} else if(dimension.type == 7) {\t//GITTER TÜR ?\r\n\t\t\t\t\t\tdrawSmallWay(context);\r\n\t\t\t\t\t\tdrawDoor(context, 1);\r\n\t\t\t\t\t} else if(dimension.type == 8) {\t//STAIR DOWN\r\n\t\t\t\t\t\tdrawStair(context);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcontext.restore();\r\n\t\t}, height: 2\r\n\t});\r\n\r\n\tfunction drawSmallWay(context) {\r\n\t\tcontext.fillStyle = $colors.background;\r\n\r\n\t\tlet x = dimension.x * $tileSize;\r\n\t\tlet y = dimension.y * $tileSize;\r\n\t\tlet w = $tileSize;\r\n\t\tlet h = $tileSize;\r\n\r\n\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\th /= 2;\r\n\t\t\ty += h/2;\r\n\t\t\tw = $tileSize / 8;\r\n\t\t} else {\r\n\t\t\tw /= 2;\r\n\t\t\tx += w/2;\r\n\t\t\th = $tileSize / 8;\r\n\t\t}\r\n\r\n\t\tcontext.fillRect(x, y, w, h);\r\n\r\n\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\tx += $tileSize - w;\r\n\t\t} else {\r\n\t\t\ty += $tileSize - h;\r\n\t\t}\r\n\r\n\t\tcontext.fillRect(x, y, w, h);\r\n\t}\r\n\r\n\tfunction drawDoor(context, style) {\r\n\t\tcontext.strokeStyle = $colors.background;\r\n\r\n\t\tlet x = dimension.x * $tileSize;\r\n\t\tlet y = dimension.y * $tileSize;\r\n\t\tlet w = $tileSize;\r\n\t\tlet h = $tileSize;\r\n\r\n\t\tif(style == 1) {\r\n\t\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\t\th /= 4;\r\n\t\t\t\ty += h * 1.5;\r\n\t\t\t} else {\r\n\t\t\t\tw /= 4;\r\n\t\t\t\tx += w * 1.5;\r\n\t\t\t}\r\n\r\n\t\t\tcontext.strokeRect(x, y, w, h);\r\n\t\t} else if(style == 5) {\r\n\t\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\t\th /= 4;\r\n\t\t\t\ty += h * 1.5;\r\n\t\t\t\tw /= 2;\r\n\t\t\t} else {\r\n\t\t\t\tw /= 4;\r\n\t\t\t\tx += w * 1.5;\r\n\t\t\t\th /= 2;\r\n\t\t\t}\r\n\r\n\t\t\tcontext.strokeRect(x, y, w, h);\r\n\r\n\t\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\t\tx += w;\r\n\t\t\t} else {\r\n\t\t\t\ty+= h;\r\n\t\t\t}\r\n\t\t\tcontext.strokeRect(x, y, w, h);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction drawHidden(context) {\r\n\t\tcontext.fillStyle = $colors.background;\r\n\r\n\t\tlet x = dimension.x * $tileSize;\r\n\t\tlet y = dimension.y * $tileSize;\r\n\t\tlet w = $tileSize;\r\n\t\tlet h = $tileSize;\r\n\r\n\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\th /= 2;\r\n\t\t\tif(dimension.dir.y == -1) y += h;\r\n\t\t} else {\r\n\t\t\tw /= 2;\r\n\t\t\tif(dimension.dir.x == -1) x += w;\r\n\t\t}\r\n\r\n\t\tcontext.fillRect(x, y, w, h);\r\n\t}\r\n\r\n\tfunction drawStair(context) {\r\n\t\tcontext.fillStyle = $colors.background;\r\n\r\n\t\tlet x = dimension.x * $tileSize;\r\n\t\tlet y = dimension.y * $tileSize;\r\n\t\tlet w = $tileSize;\r\n\t\tlet h = $tileSize;\r\n\r\n\t\tlet lineCount = 4;\r\n\t\tlet lineLength = 0.8 * $tileSize;\r\n\t\tlet lineDistance = $tileSize / 5;\r\n\r\n\t\tif(Math.abs(dimension.dir.x) == 1) {\r\n\t\t\tif(dimension.dir.x == -1) {\r\n\t\t\t\tx += $tileSize;\r\n\t\t\t\tlineDistance *= -1;\r\n\t\t\t}\r\n\r\n\t\t\tfor(let i = 0; i < lineCount; i++){\r\n\t\t\t\tx += lineDistance;\r\n\r\n\t\t\t\tcontext.moveTo(x, y + ($tileSize - lineLength)/2);\r\n\t\t\t\tcontext.lineTo(x, y + ($tileSize - lineLength)/2 + lineLength );\r\n\r\n\t\t\t\tlineLength = 0.8 * lineLength\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(Math.abs(dimension.dir.y) == 1) {\r\n\t\t\t\tif(dimension.dir.y == -1) {\r\n\t\t\t\t\ty += $tileSize;\r\n\t\t\t\t\tlineDistance *= -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(let i = 0; i < lineCount; i++){\r\n\t\t\t\t\ty += lineDistance;\r\n\r\n\t\t\t\t\tcontext.moveTo(x + ($tileSize - lineLength)/2, y);\r\n\t\t\t\t\tcontext.lineTo(x + ($tileSize - lineLength)/2 + lineLength , y);\r\n\r\n\t\t\t\t\tlineLength = 0.8 * lineLength\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcontext.stroke();\r\n\t}\r\n</script>\r\n","export { readfile, copyToClipboard };\r\nimport { game } from './stores.js';\r\n\r\nfunction readfile(binfile) {\r\n  let reader = new FileReader(binfile);\r\n  reader.onload = function(evt) {\r\n      let dungeon = JSON.parse(reader.result);\r\n\r\n      let minX = 0;\r\n      let minY = 0;\r\n\r\n      let hover = {x: 0, y: 0, w: 1, h: 1};\r\n\r\n      for(let i in dungeon.rects) {\r\n        let room = dungeon.rects[i];\r\n\r\n        if(room.x < minX) minX = room.x\r\n        if(room.y < minY) minY = room.y\r\n      }\r\n\r\n      minX -= 1;\r\n      minY -= 1;\r\n\r\n      for(let i in dungeon.rects) {\r\n        let room = dungeon.rects[i];\r\n\r\n        room.x -= minX;\r\n        room.y -= minY;\r\n\r\n        room.visible = false;\r\n      }\r\n\r\n      for(let i in dungeon.doors) {\r\n        let room = dungeon.doors[i];\r\n\r\n        room.x -= minX;\r\n        room.y -= minY;\r\n      }\r\n\r\n      dungeon.init = true;\r\n\r\n      game.update(g => {\r\n        g.dungeon = dungeon;\r\n        g.dungeon.figures = [];\r\n        return g;\r\n      });\r\n  }\r\n\r\n  reader.readAsText(binfile);\r\n}\r\n\r\nfunction copyToClipboard(text) {\r\n  var dummy = document.createElement(\"textarea\");\r\n  document.body.appendChild(dummy);\r\n  dummy.value = text;\r\n  dummy.select();\r\n  document.execCommand(\"copy\");\r\n  document.body.removeChild(dummy);\r\n}\r\n","<script>\r\n  import { game } from './stores.js';\r\n  import { copyToClipboard, readfile } from './util.js'\r\n\r\n  let files;\r\n  $: {\r\n      if (files && files[0]) {\r\n          let binfile = files[0];\r\n          readfile(binfile);\r\n      }\r\n  }\r\n</script>\r\n\r\n<div class=\"info\">\r\n  <div class=\"card\">\r\n    <button class=\"button icon-only\" on:click={ copyToClipboard($game.id) }>\r\n      <img alt=\"Copy Game Link\" title=\"Copy Game Link\" src=\"https://icongr.am/feather/copy.svg?size=16\">\r\n    </button>\r\n    <b> { $game.name } </b><br>\r\n\r\n      {#each $game.playerNames as player}\r\n        <span class:text-primary={ player.isYou }> { player.name.substring(0, 20)  } { player.isMaster? \"(Master)\": \"\"} </span><br>\r\n      {/each}\r\n\r\n  </div>\r\n  {#if $game.thisPlayer.isMaster && !$game.dungeon.init}\r\n    <input class=\"button primary\" type=\"file\" bind:files />\r\n  {/if}\r\n</div>\r\n\r\n<style>\r\n.info {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  max-width: 25%;\r\n}\r\n</style>\r\n","const key = {};\r\n\r\nexport { key };\r\n","<script>\r\n\timport { onMount, setContext, createEventDispatcher } from 'svelte';\r\n\timport { fade } from 'svelte/transition';\r\n\timport { key } from './menu.js';\r\n\r\n\texport let x;\r\n\texport let y;\r\n\r\n\t// whenever x and y is changed, restrict box to be within bounds\r\n\t$: (() => {\r\n\t\tif (!menuEl) return;\r\n\r\n\t\tconst rect = menuEl.getBoundingClientRect();\r\n\t\tx = Math.min(window.innerWidth - rect.width, x);\r\n\t\tif (y > window.innerHeight - rect.height) y -= rect.height;\r\n\t})(x, y);\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tsetContext(key, {\r\n\t\tdispatchClick: () => dispatch('click')\r\n\t});\r\n\r\n\tlet menuEl;\r\n\tfunction onPageClick(e) {\r\n\t\tif (e.target === menuEl || menuEl.contains(e.target)) return;\r\n\t\tdispatch('clickoutside');\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\tdiv {\r\n\t\tposition: absolute;\r\n\t\tdisplay: grid;\r\n\t\tborder: 1px solid #0003;\r\n\t\tbox-shadow: 2px 2px 5px 0px #0002;\r\n\t\tbackground: white;\r\n\t}\r\n</style>\r\n\r\n<svelte:body on:click={onPageClick} />\r\n\r\n<div transition:fade={{ duration: 100 }} bind:this={menuEl} style=\"top: {y}px; left: {x}px;\">\r\n\t<slot />\r\n</div>\r\n","<script>\r\n\timport { onMount, getContext } from 'svelte';\r\n\timport { key } from './menu.js';\r\n\r\n\texport let isDisabled = false;\r\n\texport let text = '';\r\n\r\n\timport { createEventDispatcher } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tconst { dispatchClick } = getContext(key);\r\n\r\n\tconst handleClick = e => {\r\n\t\tif (isDisabled) return;\r\n\r\n\t\tdispatch('click');\r\n\t\tdispatchClick();\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\tdiv {\r\n\t\tpadding: 4px 15px;\r\n\t\tcursor: default;\r\n\t\tfont-size: 14px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgrid-gap: 5px;\r\n\t}\r\n\tdiv:hover {\r\n\t\tbackground: #0002;\r\n\t}\r\n\tdiv.disabled {\r\n\t\tcolor: #0006;\r\n\t}\r\n\tdiv.disabled:hover {\r\n\t\tbackground: white;\r\n\t}\r\n</style>\r\n\r\n<div\r\n  class:disabled={isDisabled}\r\n  on:click={handleClick}\r\n>\r\n\t{#if text}\r\n\t\t{text}\r\n\t{:else}\r\n\t\t<slot />\r\n\t{/if}\r\n</div>\r\n","<script>\r\n  import { fade } from 'svelte/transition';\r\n  import { createEventDispatcher } from 'svelte';\r\n  import { colors } from '../visuals/game.js';\r\n\r\n  let name=\"\";\r\n  let color = '#ff3e00';\r\n\r\n  function overlay_click(e) {\r\n      if ('close' in e.target.dataset)\r\n          show = false;\r\n  }\r\n\r\n  const dispatch = createEventDispatcher();\r\n  function acceptModal() {\r\n    if(!$colors.lastFigureColors.includes(color)) $colors.lastFigureColors.push(color);\r\n    while($colors.lastFigureColors.length > 11) {\r\n      $colors.lastFigureColors.shift();\r\n    }\r\n\r\n    let data = {\r\n      name: name,\r\n      color: color\r\n    }\r\n    dispatch('accept', data);\r\n    show = false;\r\n  }\r\n\r\n  function setColor(c) {\r\n    color = c;\r\n  }\r\n\r\n  function hideModal() {\r\n    show = false;\r\n  }\r\n\r\n  export let show = false;\r\n</script>\r\n\r\n{#if show}\r\n  <div>\r\n    <div class=\"modal-overlay\" data-close on:click={overlay_click} transition:fade={{duration: 150}}>\r\n      <div class=\"modal-container\">\r\n\r\n\t     <div class=\"content\">\r\n         <div class=\"title\"><b>Enter Figure Details</b></div>\r\n         <div><input placeholder=\"Enter the figures Name\" class=\"is-rounded\" bind:value={name} /></div>\r\n         <div class=\"flex\"> <input type=\"color\" bind:value={color} style=\"height: 50px;\"> <span>Select figures Color</span>\r\n        </div>\r\n\r\n        <div class=\"lastUsed\">\r\n          {#each [...$colors.lastFigureColors].reverse() as c}\r\n             <button class=\"button outline\" style={\"background-color: \" + c} on:click={setColor(c)}> </button>\r\n          {/each}\r\n        </div>\r\n\r\n         <div class=\"row\">\r\n            <div class=\"col\"></div>\r\n            <div class=\"col-2\">\r\n              <button class=\"button is-full-width\" on:click={hideModal}> Cancel </button>\r\n            </div>\r\n            <div class=\"col-2\">\r\n              <button class=\"button primary is-full-width\" on:click={acceptModal}> Add </button>\r\n            </div>\r\n         </div>\r\n       </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n{/if}\r\n\r\n<style>\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  z-index: 10;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n}\r\n.modal-container {\r\n  position: relative;\r\n  background-color: #ffffff;\r\n  bottom: 200px;\r\n  width: 50vw;\r\n  margin: 1rem auto 0.2rem;\r\n  box-shadow: 0 3px 10px #555;\r\n}\r\n\r\n.flex {\r\n  display: flex;\r\n\talign-items: center;\r\n  margin-top: 10px;\r\n}\r\n\r\n.flex span {\r\n  margin-left: 8px;\r\n}\r\n\r\n.content {\r\n  margin-left: 20px;\r\n  margin-right: 20px;\r\n  margin-bottom: 20px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.title {\r\n  margin-bottom: 32px;\r\n  font-size: 24px;\r\n}\r\n\r\n.lastUsed {\r\n  margin-bottom: 8px;\r\n}\r\n</style>\r\n","<script>\r\n\timport Menu from './Menu.svelte';\r\n\timport MenuOption from './MenuOption.svelte';\r\n\timport MenuDivider from './MenuDivider.svelte';\r\n\timport { tick } from 'svelte';\r\n\timport { mouse } from '../visuals/mouse.js';\r\n\timport { game } from '../stores.js';\r\n\timport { cam } from '../visuals/game.js';\r\n\timport { sendCreateFigure, sendDeleteFigure } from '../WebHandler.js';\r\n\timport Modal from './Modal.svelte';\r\n\r\n\tlet pos = { x: 0, y: 0 };\r\n\tlet figName = \"\";\r\n\r\n\tlet showMenu = false;\r\n\tlet showModal = false;\r\n\r\n\tasync function onRightClick(e) {\r\n\t\tif (showMenu) {\r\n\t\t\tshowMenu = false;\r\n\t\t\tawait new Promise(res => setTimeout(res, 100));\r\n\t\t}\r\n\r\n\t\tlet x = Math.round($mouse.tileX * 2) / 2 - 0.5;\r\n    let y = Math.round($mouse.tileY * 2) / 2 - 0.5;\r\n\r\n\t\tpos = { x: $mouse.screenX, y: $mouse.screenY, tileX: x, tileY: y };\r\n\r\n\t\tlet fig = $game.dungeon.figures.find(f => f.x === x && f.y === y);\r\n\t\tif(fig) figName = fig.name? fig.name: \"Unnamed figure\";\r\n\t\telse figName = \"\";\r\n\r\n\t\tshowMenu = true;\r\n\t}\r\n\r\n\tfunction closeMenu() {\r\n\t\tshowMenu = false;\r\n\t}\r\n\r\n\tfunction clickAddFigure() {\r\n\t\tshowModal = true;\r\n\t}\r\n\r\n\tfunction addFigure(ev) {\r\n\t\tlet data = ev.detail;\r\n\t\tlet fig = {\r\n\t\t\tx: pos.tileX,\r\n\t\t\ty: pos.tileY,\r\n\t\t\tname: data.name,\r\n\t\t\tcolor: data.color\r\n\t\t}\r\n\r\n\t\tsendCreateFigure(fig, $game.id, $game.thisPlayer.id);\r\n\t}\r\n\r\n\tfunction deleteFigure() {\r\n\t\tlet fig = {\r\n\t\t\tx: pos.tileX,\r\n\t\t\ty: pos.tileY\r\n\t\t}\r\n\t\tsendDeleteFigure(fig, $game.id, $game.thisPlayer.id);\r\n\t}\r\n\r\n\tfunction resetCamera() {\r\n\t\t$cam.dx = 0;\r\n\t\t$cam.dy = 0;\r\n\t}\r\n</script>\r\n\r\n{#if showMenu}\r\n\t<Menu {...pos} on:click={closeMenu} on:clickoutside={closeMenu}>\r\n\t\t{#if figName.length > 0 && $game.thisPlayer.isMaster}\r\n\t\t\t<MenuOption\r\n\t\t\t\ton:click={deleteFigure}\r\n\t\t\t\ttext={\"Delete \" + figName} />\r\n\t\t{:else if $game.thisPlayer.isMaster}\r\n\t\t\t<MenuOption\r\n\t\t\t\ton:click={clickAddFigure}\r\n\t\t\t\ttext=\"Add Figure\" />\r\n\t\t{/if}\r\n\t\t<MenuOption\r\n\t\t\ton:click={resetCamera}\r\n\t\t\ttext=\"Reset Camera\" />\r\n\t</Menu>\r\n{/if}\r\n\r\n<Modal bind:show={showModal} on:accept={addFigure} />\r\n\r\n<svelte:body on:contextmenu|preventDefault={onRightClick} />\r\n","<script>\r\n\timport { renderable, width, height, tileSize } from './game.js';\r\n  import { mouse } from './mouse.js';\r\n\r\n\trenderable({\r\n\t\trender: (props, dt) => {\r\n\t\t\tconst { context, width, height } = props;\r\n\t\t\tcontext.save();\r\n\r\n\t\t\tif($mouse.pick) {\r\n        let x = Math.round($mouse.tileX * 2 - 1) * $tileSize / 2;\r\n        let y = Math.round($mouse.tileY * 2 - 1) * $tileSize / 2;\r\n        let w = $tileSize - 8;\r\n        let h = $tileSize - 8;\r\n\r\n        context.beginPath();\r\n        context.fillStyle = $mouse.pick.color + \"AA\";\r\n        context.ellipse(x + $tileSize/2, y + $tileSize/2, w/2, h/2, 0, 0, Math.PI * 2);\r\n        context.closePath();\r\n        context.fill();\r\n        context.beginPath();\r\n      }\r\n\r\n\t\t\tcontext.restore();\r\n\t\t}, height: 8\r\n\t});\r\n</script>\r\n","<script>\r\n  import { game } from './stores.js';\r\n  import { mouse } from './visuals/mouse.js'\r\n  import { sendShowRoom, sendShowDoor, sendHideDoor, sendHideRoom } from './WebHandler.js';\r\n  import Canvas from './visuals/Canvas.svelte';\r\n  import Grid from './visuals/Grid.svelte';\r\n  import Background from './visuals/Background.svelte';\r\n  import Room from './visuals/Room.svelte';\r\n  import Figure from './visuals/Figure.svelte'\r\n  import Hover from './visuals/Hover.svelte';\r\n  import Door from './visuals/Door.svelte';\r\n  import GameInfoBar from './GameInfoBar.svelte';\r\n\timport CustomMenu from './contextmenu/CustomMenu.svelte';\r\n  import FigureDrag from './visuals/FigureDrag.svelte';\r\n  import { tileSize, cam, pixelRatio } from './visuals/game.js';\r\n\r\n\r\n  let hover = {x: 0, y: 0, w: 1, h: 1};\r\n\r\n  function onClick(ev) {\r\n\t\tlet data = ev.detail;\r\n\t\tlet room = $game.dungeon.rects.find(room => data.tileX >= room.x && data.tileX < room.x + room.w && data.tileY >= room.y && data.tileY <= room.y + room.h);\r\n    let door = $game.dungeon.doors.find(room => Math.floor(data.tileX) == room.x && Math.floor(data.tileY) == room.y);\r\n\r\n\t\tif(room) {\r\n      if(!room.visible) {\r\n        sendShowRoom(room, $game.id, $game.thisPlayer.id);\r\n        if(door) sendShowDoor(door, $game.id, $game.thisPlayer.id);\r\n      } else {\r\n        sendHideRoom(room, $game.id, $game.thisPlayer.id);\r\n        if(door) sendHideDoor(door, $game.id, $game.thisPlayer.id);\r\n      }\r\n    }\r\n\t}\r\n\r\n\tfunction mousemove(ev) {\r\n\t\tlet mousePos = {x: $mouse.tileX, y: $mouse.tileY}\r\n\t\thover = $game.dungeon.rects.find(room => mousePos.x >= room.x && mousePos.x < room.x + room.w && mousePos.y >= room.y && mousePos.y <= room.y + room.h);\r\n  }\r\n\r\n  function pick(ev) {\r\n    let x = Math.round($mouse.tileX * 2) / 2 - 0.5;\r\n    let y = Math.round($mouse.tileY * 2) / 2 - 0.5;\r\n    let fig = $game.dungeon.figures.find(f => f.x === x && f.y === y);\r\n    $mouse.pick = fig;\r\n  }\r\n</script>\r\n\r\n\r\n<GameInfoBar />\r\n\r\n{#if $game.dungeon.init}\r\n<div id=\"canvasDisplay\" on:mousemove={mousemove}>\r\n  <Canvas on:click={onClick} on:down={pick}>\r\n    <Background>\r\n    </Background>\r\n\r\n    {#each $game.dungeon.rects as room}\r\n      <Room dimension={room} />\r\n    {/each}\r\n\r\n    {#each $game.dungeon.doors as room}\r\n      <Door bind:dimension={room} />\r\n    {/each}\r\n\r\n    <Grid />\r\n    {#if $game.thisPlayer.isMaster}\r\n      <Hover bind:dimension={hover} />\r\n    {/if}\r\n\r\n    {#each $game.dungeon.figures as fig}\r\n      <Figure pos={fig}/>\r\n    {/each}\r\n\r\n    <FigureDrag />\r\n  </Canvas>\r\n\r\n  <CustomMenu />\r\n</div>\r\n{/if}\r\n","<script>\r\n  import { error, resetError } from './errorstore.js';\r\n  import { fly } from 'svelte/transition';\r\n</script>\r\n\r\n{#if $error.message}\r\n<div class=\"bg-error text-white flex-container\" transition:fly={{y: -100, opacity: 1}}>\r\n\t<span class=\"\"> { $error.message } </span>\r\n\t<button class=\"button clear icon-only\" on:click={ resetError }>\r\n\t\t<img alt=\"Close Error\" title=\"Close Error\" src=\"https://icongr.am/feather/x.svg?size=16&color=FFFFFF\">\r\n\t</button>\r\n</div>\r\n{/if}\r\n\r\n<style>\r\n.flex-container {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n}\r\n\r\n.bg-error {\r\n\tpadding-left: 16px;\r\n\tposition: fixed;\r\n\twidth: 100%;\r\n\tz-index: 10;\r\n}\r\n</style>\r\n","<script>\n\timport Login from './LoginScreen.svelte';\n\timport DungeonView from './DungeonView.svelte';\n\timport ErrorDisplay from './ErrorDisplay.svelte';\n\timport { game } from './stores.js';\n\timport { sendPlayerLeave } from './WebHandler.js';\n\timport { onDestroy } from 'svelte';\n\n\tonDestroy(() => {\n\t\tsendPlayerLeave($game.id, $game.thisPlayer.id);\n\t});\n</script>\n\n<ErrorDisplay />\n{#if $game.id == -1}\n\t<Login />\n{:else}\n\t<DungeonView />\n{/if}\n\n<style>\n:global(:root) {\n\t--bg-color: #ffffff;\n\t--bg-secondary-color: #f3f3f6;\n\t--color-primary: #14854F;\n\t--color-lightGrey: #d2d6dd;\n\t--color-grey: #747681;\n\t--color-darkGrey: #3f4144;\n\t--color-error: #d43939;\n\t--color-success: #28bd14;\n\t--grid-maxWidth: 120rem;\n\t--grid-gutter: 2rem;\n\t--font-size: 1.6rem;\n\t--font-color: #333;\n\t--font-family-sans: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen-Sans, Ubuntu, Cantarell, \"Helvetica Neue\", sans-serif;\n\t--font-family-mono: monaco, \"Consolas\", \"Lucida Console\", monospace;\n}\n</style>\n","import App from './App.svelte';\n\nconst app = new App({\n\ttarget: document.body,\n\tprops: {}\n});\n\nexport default app;\n"],"names":["noop","identity","x","assign","tar","src","k","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","subscribe","store","callbacks","unsub","unsubscribe","get_store_value","value","_","component_subscribe","component","callback","$$","on_destroy","push","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","slice","update_slot","slot","slot_definition","dirty","get_slot_changes_fn","get_slot_context_fn","slot_changes","lets","undefined","merged","len","Math","max","length","i","get_slot_changes","slot_context","p","set_store_value","ret","set","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","c","delete","f","size","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","d","element","name","document","createElement","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","set_data","wholeText","set_input_value","input","set_style","key","important","style","setProperty","toggle_class","toggle","classList","custom_event","type","detail","e","createEvent","initCustomEvent","active_docs","current_component","active","create_rule","duration","delay","ease","uid","step","keyframes","t","rule","str","hash","charCodeAt","doc","ownerDocument","add","stylesheet","__svelte_stylesheet","head","sheet","current_rules","__svelte_rules","insertRule","cssRules","animation","delete_rule","previous","split","next","filter","anim","indexOf","deleted","join","deleteRule","clear","set_current_component","get_current_component","Error","onMount","on_mount","createEventDispatcher","call","setContext","context","getContext","get","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","add_flush_callback","flushing","seen_callbacks","flush","update","pop","has","fragment","before_update","after_update","promise","dispatch","direction","kind","dispatchEvent","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","null_transition","create_bidirectional_transition","params","intro","config","running_program","pending_program","animation_name","clear_animation","init","program","abs","start","end","group","go","easing","tick","css","fulfill","loop","[object Object]","then","globals","globalThis","global","bind","index","props","bound","create_component","mount_component","m","new_on_destroy","map","destroy_component","make_dirty","fill","instance","create_fragment","not_equal","parent_component","prop_values","Map","skip_bound","ready","rest","hydrate","nodes","Array","from","childNodes","children","l","SvelteComponent","this","$destroy","splice","$$props","obj","$$set","keys","cubicOut","fade","linear","getComputedStyle","opacity","fly","y","target_opacity","transform","od","u","subscriber_queue","writable","stop","subscribers","new_value","run_queue","s","invalidate","subscriber","derived","stores","initial_value","single","isArray","stores_array","auto","inited","values","pending","cleanup","sync","result","unsubscribers","game","id","error","message","timeout","setError","clearTimeout","timeput","setInterval","resetError","host","socketConnection","sendRequest","reject","xmlhttp","XMLHttpRequest","onload","status","JSON","parse","responseText","onerror","er","isError","open","setRequestHeader","send","openSocket","gameID","playerID","WebSocket","onopen","action","pid","gid","stringify","onmessage","console","log","playerName","user","g","playerNames","room","thisPlayer","isMaster","dungeon","rects","find","w","h","visible","doors","showDoor","door","close","playerIndex","findIndex","doorIndex","roomIndex","hideRoom","fig","figure","figures","to","moveFigure","figureIndex","removeFigure","gameName","loading","answer","masterName","createGame","$game","isYou","player","joinGame","mouse","screenX","screenY","worldX","worldY","tileX","tileY","entered","pick","down","width","innerWidth","height","innerHeight","pixelRatio","devicePixelRatio","canvas","cam","dx","dy","time","tileSize","colors","background","rooms","lastFigureColors","array","reduce","dict","deriveObject","Symbol","renderable","render","api","mounted","setup","remove","enter","clickStart","frame","killLoopOnError","attributes","listeners","canvasStore","contextStore","elapsed","lastTime","beginTime","dt","cancelAnimationFrame","createLoop","save","translate","$cam","scale","$pixelRatio","entity","$props","err","warn","restore","sort","e1","e2","idx","ev","$mouse","timeDis","newPos","newX","round","newY","dataStr","sendMoveFigure","button","$tileSize","color","$colors","pr","offX","floor","ceil","offY","min","beginPath","strokeStyle","moveTo","lineTo","stroke","clearRect","fillStyle","fillRect","dimension","rotunda","ellipse","PI","closePath","baseline","pos","fontSize","fontFamily","font","textBaseline","textWidth","measureText","fillText","lineWidth","strokeRect","drawSmallWay","dir","drawDoor","drawStair","lineLength","lineDistance","drawHidden","copyToClipboard","dummy","body","select","execCommand","substring","files","binfile","reader","FileReader","evt","minX","minY","readAsText","readfile","menuEl","dispatchClick","rect","getBoundingClientRect","contains","isDisabled","reverse","show","dataset","includes","shift","levels","updates","to_null_out","accounted_for","n","spread_props","preventDefault","figName","showMenu","showModal","res","setTimeout","sendCreateFigure","sendDeleteFigure","hover","sendHideRoom","sendHideDoor","sendShowRoom","sendShowDoor","mousePos","sendPlayerLeave"],"mappings":"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"}